/* Mobile overrides that WIN no matter what */
@media (max-width: 768px) {
  /* Kill any body flex/grid coming from shared styles */
  html body {
    display: block !important;
    padding-top: 60px !important;
  }

  /* If wrapper exists, stack deck -> chat */
  .layout {
    display: grid !important;
    grid-template-columns: 1fr !important;
    grid-template-rows: auto auto !important;
    grid-template-areas:
      "deck"
      "chat" !important;
    min-height: auto !important;
  }

  /* If wrapper DIDN'T exist, safety script creates it; these still help */
  .content-panel {
    grid-area: deck !important;
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    position: static !important;
    float: none !important;
    flex: none !important;

    min-height: 55svh !important;
    max-height: 55svh !important;
    border-right: none !important;
    border-bottom: 1px solid rgba(255,255,255,0.1) !important;
    padding: 20px 20px 10px 20px !important;
    justify-content: flex-start !important;
  }

  .chat-panel {
    grid-area: chat !important;
    width: 100% !important;
    max-width: 100% !important;
    min-width: 0 !important;
    position: static !important;
    float: none !important;
    flex: none !important;

    /*min-height: 45svh !important;
    max-height: 45svh !important;*/
    border-right: none !important;
    border-top: 1px solid rgba(255,255,255,0.1) !important;
    padding: 5px 10px !important;
    justify-content: flex-start !important;
  }

  .chat-messages {
    /*max-height: 35svh !important;*/
    margin-top: 0 !important;
    padding-top: 5px !important;
  }

  .shuffle-container { padding-top: 5px !important; }

  /* Card selection sizing */
  .card { width: 80px !important; height: 120px !important; }
  .card-row { height: 200px !important; }

  /* Popup sizing */
  .popup-container { width: 90% !important; height: 500px !important; }

  /* Carousel sizing */
  .carousel-card { width: 150px !important; height: 225px !important; }
  .carousel-card.prev { transform: translateX(-120px) scale(0.8) rotateY(10deg) !important; }
  .carousel-card.next { transform: translateX(120px) scale(0.8) rotateY(-10deg) !important; }
}

@media (max-width: 768px) {
  /* Fallback for older browsers */
  .content-panel { min-height: 55vh; max-height: 55vh; }
  .chat-panel    { min-height: 45vh; max-height: 45vh; }
  .chat-messages { max-height: 35vh; }

  /* Use modern viewport units when supported */
  @supports (height: 100svh) {
   /* .content-panel { min-height: 55svh; max-height: 55svh; } */
    .chat-panel    { min-height: 45svh; max-height: 45svh; }
    .chat-messages { max-height: 35svh; }
  }

  /* Smooth scrolling feel */
  .chat-messages {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }
}

@media (max-width: 768px) {
  .chat-card-thumb {
    margin: 8px 0 16px 52px;            /* aligns under avatar bubble */
    display: flex;
    flex-direction: column;
    align-items: flex-start;
  }
  .chat-card-thumb .thumb-label {
    font-size: 12px;
    color: rgba(255,255,255,0.7);
    margin-bottom: 6px;
    text-transform: uppercase;
    letter-spacing: .04em;
  }
  .chat-card-thumb .thumb-img {
    width: 100px;
    height: 150px;
    object-fit: cover;
    border-radius: 8px;
    border: 1px solid rgba(255,255,255,0.08);
    box-shadow: 0 6px 18px rgba(0,0,0,.5);
  }
}

/* Just in case: hide these thumbs on desktop */
@media (min-width: 769px) {
  .chat-card-thumb { display: none; }
}


@media (max-width: 768px) {
  /* Make each panel a fixed-height flex column */
  .content-panel {
    height: 55svh !important;
    min-height: 0 !important;
    max-height: none !important;
    display: flex !important;
    flex-direction: column !important;
    overflow: hidden !important;
  }

  .chat-panel {
    height: 45svh !important;
    min-height: 0 !important;
    max-height: none !important;
    display: flex !important;
    flex-direction: column !important;
    overflow: hidden !important;
  }

  /* The magic: let messages be the scroll area */
  .chat-messages {
    flex: 1 1 auto !important;
    min-height: 0 !important;              /* <-- critical in flex layouts */
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
    max-height: none !important;            /* donâ€™t fight with height math */
  }
}